/// TODO: test default differentiabl getValueAndJacobian.